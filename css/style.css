/* ================================================
   Minna no Nihongo 1 — Vocabulary Quiz
   Clean, responsive, distraction-free UI
   ================================================ */

/* ---------- CSS Variables / Theming ---------- */
:root {
  /* Light theme (default) */
  --bg:            #f5f5f7;
  --bg-card:       #ffffff;
  --bg-header:     #ffffff;
  --text:          #1d1d1f;
  --text-muted:    #6e6e73;
  --border:        #d2d2d7;
  --primary:       #0071e3;
  --primary-hover: #0059b3;
  --accent:        #5856d6;
  --accent-hover:  #4240a8;
  --success:       #34c759;
  --success-bg:    #e8f9ed;
  --danger:        #ff3b30;
  --danger-bg:     #fce8e6;
  --warning:       #ff9500;
  --shadow:        0 1px 3px rgba(0,0,0,.08);
  --shadow-lg:     0 4px 16px rgba(0,0,0,.10);
  --radius:        12px;
  --radius-sm:     8px;
  --font:          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
  --font-jp:       "Noto Sans JP", "Hiragino Kaku Gothic Pro", "Yu Gothic", sans-serif;
  --font-cn:       "Noto Sans SC", "PingFang SC", "Microsoft YaHei", "SimHei", sans-serif;
  --transition:    .2s ease;
}

[data-theme="dark"] {
  --bg:            #1c1c1e;
  --bg-card:       #2c2c2e;
  --bg-header:     #2c2c2e;
  --text:          #f5f5f7;
  --text-muted:    #98989d;
  --border:        #48484a;
  --primary:       #4da3ff;
  --primary-hover: #3d8de0;
  --accent:        #7a78e8;
  --accent-hover:  #6563c0;
  --success:       #30d158;
  --success-bg:    #1a3a24;
  --danger:        #ff453a;
  --danger-bg:     #3a1a1a;
  --shadow:        0 1px 3px rgba(0,0,0,.3);
  --shadow-lg:     0 4px 16px rgba(0,0,0,.4);
}

/* ---------- Reset / Base ---------- */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  min-height: 100vh;
  transition: background var(--transition), color var(--transition);
}

/* ---------- Header ---------- */
#app-header {
  position: sticky;
  top: 0;
  z-index: 100;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: .75rem 1.25rem;
  background: var(--bg-header);
  border-bottom: 1px solid var(--border);
  box-shadow: var(--shadow);
  transition: background var(--transition), border-color var(--transition);
}

.header-left {
  display: flex;
  align-items: center;
  gap: .6rem;
}

#header-title {
  font-size: 1.1rem;
  font-weight: 700;
  white-space: nowrap;
}

.icon-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border: none;
  border-radius: 50%;
  background: transparent;
  color: var(--text);
  cursor: pointer;
  transition: background var(--transition);
}
.icon-btn:hover {
  background: var(--border);
}

/* ---------- Main / Screens ---------- */
#app {
  max-width: 800px;
  margin: 0 auto;
  padding: 1.5rem 1rem 3rem;
}

.screen {
  display: none;
}
.screen.active {
  display: block;
  animation: fadeIn .25s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}

.screen-heading {
  font-size: 1.35rem;
  font-weight: 700;
  margin-bottom: 1.25rem;
}

.text-muted {
  color: var(--text-muted);
  font-size: .9rem;
  margin-bottom: 1.25rem;
}

/* ---------- Course Selector Tabs (JLPT / HSK) ---------- */
.course-tabs {
  display: flex;
  gap: .5rem;
  margin-bottom: 1.25rem;
}

.course-tab {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: .2rem;
  padding: .75rem 1rem;
  background: var(--bg-card);
  border: 2px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: border-color .15s, background .15s, color .15s;
  color: var(--text-muted);
}

.course-tab:hover {
  border-color: var(--primary);
  color: var(--text);
}

.course-tab.active {
  border-color: var(--primary);
  background: color-mix(in srgb, var(--primary) 12%, var(--bg-card));
  color: var(--primary);
}

.course-tab-flag {
  font-size: 1.6rem;
  line-height: 1;
}

.course-tab-label {
  font-size: 1rem;
  font-weight: 700;
  letter-spacing: .05em;
}

.course-tab-sub {
  font-size: .75rem;
  opacity: .8;
}

/* ---------- HSK coming-soon placeholder ---------- */
.hsk-coming-soon {
  grid-column: 1 / -1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: .75rem;
  padding: 3rem 1.5rem;
  text-align: center;
  color: var(--text-muted);
  border: 2px dashed var(--border);
  border-radius: var(--radius);
}

.hsk-coming-soon-icon {
  font-size: 3rem;
  line-height: 1;
}

.hsk-coming-soon h3 {
  margin: 0;
  font-size: 1.1rem;
  color: var(--text);
}

.hsk-coming-soon p {
  margin: 0;
  font-size: .9rem;
  line-height: 1.6;
}

/* ---------- Lesson Grid ---------- */
.lesson-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: .75rem;
}

.lesson-card {
  position: relative;
  display: flex;
  flex-direction: column;
  padding: 1rem 1.1rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
  text-decoration: none;
  color: var(--text);
}
.lesson-card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
  border-color: var(--primary);
}
.lesson-card .lesson-number {
  font-size: .8rem;
  font-weight: 700;
  color: var(--primary);
  text-transform: uppercase;
  letter-spacing: .04em;
  margin-bottom: .25rem;
}
.lesson-card .lesson-title {
  font-size: .95rem;
  font-weight: 600;
  line-height: 1.4;
}
.lesson-card .lesson-meta {
  font-size: .78rem;
  color: var(--text-muted);
  margin-top: .4rem;
}
.lesson-card .lesson-progress-bar {
  margin-top: .5rem;
  height: 4px;
  background: var(--border);
  border-radius: 2px;
  overflow: hidden;
}
.lesson-card .lesson-progress-bar .fill {
  height: 100%;
  background: var(--success);
  border-radius: 2px;
  transition: width .3s ease;
}

/* ---------- Lesson Menu ---------- */
.menu-actions {
  display: flex;
  flex-direction: column;
  gap: .75rem;
  max-width: 420px;
}

/* Menu section divider */
.menu-section-divider {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin: 1rem 0;
}

.menu-divider-line {
  flex: 1;
  height: 1px;
  background: var(--border);
  border: none;
}

.menu-divider-text {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* ---------- Buttons ---------- */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  padding: .6rem 1.2rem;
  font-size: .95rem;
  font-weight: 600;
  font-family: inherit;
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: background var(--transition), transform .1s ease, box-shadow var(--transition);
  text-decoration: none;
  line-height: 1.4;
}
.btn:active {
  transform: scale(.97);
}
.btn:disabled {
  opacity: .5;
  cursor: not-allowed;
}

.btn-lg {
  padding: .85rem 1.5rem;
  font-size: 1rem;
}

.btn-primary {
  background: var(--primary);
  color: #fff;
}
.btn-primary:hover { background: var(--primary-hover); }

.btn-accent {
  background: var(--accent);
  color: #fff;
}
.btn-accent:hover { background: var(--accent-hover); }

.btn-success {
  background: var(--success);
  color: #fff;
}
.btn-success:hover { opacity: .85; }

.btn-danger {
  background: var(--danger);
  color: #fff;
}
.btn-danger:hover { opacity: .85; }

.btn-secondary {
  background: var(--border);
  color: var(--text);
}
.btn-secondary:hover { opacity: .8; }

.btn-outline {
  background: transparent;
  color: var(--text);
  border: 1.5px solid var(--border);
}
.btn-outline:hover {
  background: var(--border);
}

/* ---------- Progress Bar ---------- */
.progress-bar-wrapper {
  margin-bottom: 1.5rem;
}
.progress-text {
  font-size: .85rem;
  font-weight: 600;
  color: var(--text-muted);
  margin-bottom: .4rem;
  text-align: right;
}
.progress-bar {
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: var(--primary);
  border-radius: 3px;
  transition: width .35s ease;
  width: 0;
}

/* ---------- Flashcard ---------- */
.flashcard {
  perspective: 800px;
  width: 100%;
  max-width: 480px;
  height: 280px;
  margin: 0 auto 1rem;
  cursor: pointer;
  outline: none;
}
.flashcard-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transition: transform .5s ease;
  transform-style: preserve-3d;
}
.flashcard.flipped .flashcard-inner {
  transform: rotateY(180deg);
}
.flashcard-front, .flashcard-back {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 1.5rem;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-lg);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}
.flashcard-back {
  transform: rotateY(180deg);
}
.fc-japanese {
  font-family: var(--font-jp);
  font-size: 2rem;
  font-weight: 700;
  text-align: center;
  line-height: 1.4;
}
.fc-kana {
  font-family: var(--font-jp);
  font-size: 1.3rem;
  color: var(--primary);
  margin-bottom: .3rem;
}
.fc-romaji {
  font-size: 0.85rem;
  color: var(--text-muted);
  font-style: italic;
  margin-bottom: 0.4rem;
  letter-spacing: 0.02em;
}
.fc-meaning {
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: .2rem;
  text-align: center;
}
.fc-english {
  font-size: .9rem;
  color: var(--text-muted);
  margin-bottom: .3rem;
}
.fc-example {
  font-family: var(--font-jp);
  font-size: .85rem;
  color: var(--text-muted);
  font-style: italic;
  text-align: center;
}

.hint-text {
  text-align: center;
  font-size: .82rem;
  color: var(--text-muted);
  margin-bottom: 1rem;
}

.fc-nav {
  display: flex;
  justify-content: center;
  gap: .5rem;
  flex-wrap: wrap;
}

/* ---------- Multiple Choice ---------- */
.quiz-question-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 1.5rem;
  margin-bottom: 1.25rem;
  box-shadow: var(--shadow);
  text-align: center;
}
.question-label {
  font-size: .82rem;
  color: var(--text-muted);
  margin-bottom: .4rem;
}
.question-text {
  font-family: var(--font-jp);
  font-size: 1.6rem;
  font-weight: 700;
  line-height: 1.4;
}
.question-romaji {
  font-size: 0.95rem;
  color: var(--text-muted);
  font-style: italic;
  margin-top: 0.5rem;
  letter-spacing: 0.02em;
}

.mc-options {
  display: flex;
  flex-direction: column;
  gap: .6rem;
  margin-bottom: 1rem;
}
.mc-option {
  display: block;
  width: 100%;
  padding: .9rem 1.2rem;
  font-size: 1rem;
  font-family: inherit;
  font-weight: 500;
  text-align: left;
  background: var(--bg-card);
  color: var(--text);
  border: 2px solid var(--border);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: border-color var(--transition), background var(--transition);
  line-height: 1.4;
}
.mc-option:hover:not(.disabled) {
  border-color: var(--primary);
}
.mc-option.correct {
  border-color: var(--success);
  background: var(--success-bg);
}
.mc-option.wrong {
  border-color: var(--danger);
  background: var(--danger-bg);
}
.mc-option.disabled {
  cursor: default;
  opacity: .7;
}
.mc-option.correct.disabled {
  opacity: 1;
}

/* MC Option - Romaji hint */
.mc-option-main {
  display: block;
  font-family: var(--font-jp);
  font-size: 1rem;
  font-weight: 500;
  margin-bottom: 0.2rem;
}

.mc-option-romaji {
  display: block;
  font-size: 0.85rem;
  font-style: italic;
  color: var(--text-muted);
  letter-spacing: 0.02em;
  line-height: 1.2;
}

/* Dark mode adjustment */
.mc-option:hover:not(.disabled) .mc-option-romaji {
  color: var(--primary);
}

/* ---------- Feedback ---------- */
.feedback {
  padding: .8rem 1rem;
  border-radius: var(--radius-sm);
  margin-bottom: 1rem;
  font-weight: 600;
  font-size: .95rem;
}
.feedback.correct {
  background: var(--success-bg);
  color: var(--success);
}
.feedback.wrong {
  background: var(--danger-bg);
  color: var(--danger);
}

/* ---------- Typing Quiz ---------- */
.typing-input-wrapper {
  display: flex;
  gap: .5rem;
  margin-bottom: 1rem;
}
.typing-input {
  flex: 1;
  padding: .75rem 1rem;
  font-size: 1.1rem;
  font-family: var(--font-jp);
  border: 2px solid var(--border);
  border-radius: var(--radius-sm);
  background: var(--bg-card);
  color: var(--text);
  outline: none;
  transition: border-color var(--transition);
}
.typing-input:focus {
  border-color: var(--primary);
}
.typing-input.correct {
  border-color: var(--success);
}
.typing-input.wrong {
  border-color: var(--danger);
}

/* Romaji hint wrapper */
.romaji-hint-wrapper {
  margin-top: 0.75rem;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
}

.btn-hint {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.8rem;
  font-size: 0.85rem;
  font-weight: 500;
  font-family: inherit;
  background: transparent;
  color: var(--text-muted);
  border: 1.5px dashed var(--border);
  border-radius: var(--radius-sm);
  cursor: pointer;
  transition: all var(--transition);
}

.btn-hint:hover {
  background: var(--border);
  color: var(--text);
}

.hint-romaji {
  font-size: 0.9rem;
  color: var(--primary);
  font-style: italic;
  padding: 0.4rem 0.8rem;
  background: var(--bg);
  border-radius: var(--radius-sm);
  letter-spacing: 0.02em;
}

/* ---------- Grammar List ---------- */
.grammar-list-container {
  display: flex;
  flex-direction: column;
  gap: 1.25rem;
}

.grammar-card {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  box-shadow: var(--shadow);
  transition: box-shadow var(--transition);
}

.grammar-card:hover {
  box-shadow: var(--shadow-lg);
}

.grammar-card-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem 1.25rem;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  color: #fff;
}

.grammar-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  font-weight: 700;
  font-size: 0.9rem;
}

.grammar-pattern {
  font-family: var(--font-jp);
  font-size: 1.3rem;
  font-weight: 700;
  margin: 0;
}

.grammar-card-body {
  padding: 1.25rem;
}

.grammar-meaning {
  font-size: 1rem;
  margin-bottom: 0.75rem;
  color: var(--text);
}

.grammar-meaning strong {
  color: var(--primary);
}

.grammar-meaning-en {
  color: var(--text-muted);
  font-size: 0.9rem;
  font-style: italic;
}

.grammar-explanation {
  font-size: 0.95rem;
  line-height: 1.7;
  color: var(--text);
  margin-bottom: 1rem;
  padding: 0.75rem;
  background: var(--bg);
  border-left: 3px solid var(--accent);
  border-radius: var(--radius-sm);
}

.grammar-examples {
  margin-top: 1rem;
}

.grammar-examples > strong {
  display: block;
  color: var(--primary);
  font-size: 0.9rem;
  margin-bottom: 0.5rem;
}

.grammar-example {
  padding: 0.75rem;
  margin-bottom: 0.75rem;
  background: var(--bg);
  border-radius: var(--radius-sm);
  border-left: 2px solid var(--success);
}

.grammar-example:last-child {
  margin-bottom: 0;
}

.grammar-example-jp {
  font-family: var(--font-jp);
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 0.3rem;
}

.grammar-example-vi {
  font-size: 0.9rem;
  color: var(--text);
  margin-bottom: 0.2rem;
}

.grammar-example-en {
  font-size: 0.85rem;
  color: var(--text-muted);
  font-style: italic;
}

/* ---------- Results ---------- */
.results-card {
  text-align: center;
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 2rem 1.5rem;
  box-shadow: var(--shadow-lg);
  max-width: 420px;
  margin: 0 auto;
}
.results-card h2 {
  font-size: 1.4rem;
  margin-bottom: 1.25rem;
}

.results-score-circle {
  position: relative;
  width: 130px;
  height: 130px;
  margin: 0 auto 1rem;
}
.score-ring {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
}
.score-ring-bg {
  fill: none;
  stroke: var(--border);
  stroke-width: 3;
}
.score-ring-fill {
  fill: none;
  stroke: var(--success);
  stroke-width: 3;
  stroke-linecap: round;
  stroke-dasharray: 0, 100;
  transition: stroke-dasharray .8s ease;
}
.score-percent {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.8rem;
  font-weight: 800;
}

.results-detail {
  font-size: 1rem;
  color: var(--text-muted);
  margin-bottom: 1.5rem;
}

.results-actions {
  display: flex;
  flex-direction: column;
  gap: .6rem;
}

/* ---------- Vocabulary Table ---------- */
.table-wrapper {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}
#vocab-table {
  width: 100%;
  border-collapse: collapse;
  font-size: .9rem;
}
#vocab-table th,
#vocab-table td {
  padding: .6rem .75rem;
  text-align: left;
  border-bottom: 1px solid var(--border);
}
#vocab-table th {
  font-weight: 700;
  font-size: .8rem;
  text-transform: uppercase;
  letter-spacing: .03em;
  color: var(--text-muted);
  background: var(--bg-card);
  position: sticky;
  top: 0;
}
#vocab-table td:nth-child(2) {
  font-family: var(--font-jp);
  font-weight: 600;
}
#vocab-table td:nth-child(3) {
  font-family: var(--font-jp);
  color: var(--primary);
}
#vocab-table td:nth-child(4) {
  font-style: italic;
  color: var(--text-muted);
  font-size: 0.85rem;
}
#vocab-table tbody tr:hover {
  background: var(--bg-card);
}

/* ---------- Utility ---------- */
.hidden {
  display: none !important;
}

/* ---------- Responsive ---------- */
@media (max-width: 600px) {
  #app {
    padding: 1rem .75rem 2rem;
  }
  .lesson-grid {
    grid-template-columns: 1fr 1fr;
    gap: .6rem;
  }
  .lesson-card {
    padding: .8rem;
  }
  .lesson-card .lesson-title {
    font-size: .85rem;
  }
  .flashcard {
    height: 240px;
  }
  .fc-japanese {
    font-size: 1.6rem;
  }
  .question-text {
    font-size: 1.3rem;
  }
  .fc-nav {
    gap: .4rem;
  }
  .fc-nav .btn {
    padding: .5rem .8rem;
    font-size: .85rem;
  }
  .typing-input-wrapper {
    flex-direction: column;
  }
  .results-card {
    padding: 1.5rem 1rem;
  }
  #header-title {
    font-size: .95rem;
  }
}

@media (max-width: 380px) {
  .lesson-grid {
    grid-template-columns: 1fr;
  }
}

/* ---------- Audio / Speak Button ---------- */
.btn-speak {
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  padding: .25rem .55rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: transparent;
  color: var(--text-muted);
  font-size: .8rem;
  cursor: pointer;
  transition: color .15s, border-color .15s, background .15s;
}

.btn-speak:hover {
  color: var(--accent);
  border-color: var(--accent);
  background: color-mix(in srgb, var(--accent) 8%, transparent);
}

.btn-speak:active {
  transform: scale(.95);
}

/* Flashcard speak button — centered below hint text */
.btn-speak--fc {
  display: flex;
  margin: .5rem auto .75rem;
  padding: .4rem 1rem;
  font-size: .875rem;
}

/* Vocab table speak column — compact */
#vocab-table .btn-speak {
  padding: .2rem .4rem;
  font-size: .85rem;
}

#vocab-table th:last-child,
#vocab-table td:last-child {
  width: 2.5rem;
  text-align: center;
}

/* ---------- HSK Vocabulary Table ---------- */
.cn-text {
  font-family: var(--font-cn);
  font-weight: 600;
  font-size: 1.15em;
}

.hsk-pinyin {
  color: var(--primary);
  font-size: .9rem;
}

#hsk-vocab-table {
  width: 100%;
  border-collapse: collapse;
  font-size: .9rem;
}

#hsk-vocab-table th,
#hsk-vocab-table td {
  padding: .55rem .75rem;
  text-align: left;
  border-bottom: 1px solid var(--border);
}

#hsk-vocab-table th {
  font-weight: 700;
  font-size: .8rem;
  text-transform: uppercase;
  letter-spacing: .03em;
  color: var(--text-muted);
  background: var(--bg-card);
  position: sticky;
  top: 0;
  z-index: 1;
}

#hsk-vocab-table tbody tr:hover {
  background: var(--bg-card);
}

#hsk-vocab-table td:nth-child(2) {
  font-family: var(--font-cn);
  font-weight: 600;
  font-size: 1.1em;
}

#hsk-vocab-table td:nth-child(3) {
  color: var(--primary);
}

#hsk-vocab-table td:last-child {
  width: 2.5rem;
  text-align: center;
}

/* ---------- Special lesson cards (Alphabet / Counters) ---------- */
.lesson-card--special {
  background: linear-gradient(135deg, var(--accent) 0%, color-mix(in srgb, var(--accent) 70%, var(--primary)) 100%);
  color: #fff;
  cursor: pointer;
  align-items: center;
  text-align: center;
  gap: .3rem;
}

.lesson-card--special .lesson-title,
.lesson-card--special .lesson-meta {
  color: rgba(255,255,255,.92);
}

.lesson-card--special .lesson-meta {
  font-size: .8rem;
  opacity: .85;
}

.lesson-special-icon {
  font-size: 1.75rem;
  line-height: 1;
  margin-bottom: .15rem;
}

/* ---------- Tab buttons (shared by Alphabet + Counters) ---------- */
.alpha-tabs {
  display: flex;
  gap: .5rem;
  margin-bottom: 1.25rem;
  border-bottom: 2px solid var(--border);
  padding-bottom: .5rem;
}

.tab-btn {
  padding: .45rem 1.1rem;
  border: 1px solid var(--border);
  border-radius: 8px 8px 0 0;
  background: transparent;
  color: var(--text-muted);
  font-size: .9rem;
  cursor: pointer;
  transition: background .15s, color .15s;
}

.tab-btn.active,
.tab-btn:hover {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
}

/* ---------- Alphabet Grid ---------- */
.alpha-grid-wrap {
  overflow-x: auto;
}

.alpha-table {
  border-collapse: collapse;
  margin-bottom: 1.5rem;
  min-width: 320px;
}

.alpha-table th,
.alpha-table td {
  border: 1px solid var(--border);
  padding: .35rem .5rem;
  text-align: center;
  min-width: 3.2rem;
}

.alpha-table thead th {
  background: var(--surface);
  font-size: .75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: .05em;
}

.alpha-row-label {
  font-size: .75rem;
  color: var(--text-muted);
  background: var(--surface);
  white-space: nowrap;
}

.alpha-cell {
  cursor: default;
  vertical-align: middle;
}

.alpha-cell--audio {
  cursor: pointer;
  transition: background .12s;
}

.alpha-cell--audio:hover {
  background: color-mix(in srgb, var(--accent) 12%, transparent);
}

.alpha-cell--empty {
  background: var(--surface);
}

.alpha-kana {
  display: block;
  font-family: var(--font-jp);
  font-size: 1.3rem;
  line-height: 1.2;
}

.alpha-romaji {
  display: block;
  font-size: .65rem;
  color: var(--text-muted);
  margin-top: .1rem;
}

.alpha-section-heading {
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-muted);
  margin: 1rem 0 .6rem;
}

.alpha-combo-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(3.5rem, 1fr));
  gap: .35rem;
  margin-bottom: 1.5rem;
}

.alpha-combo-cell {
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: .3rem .2rem;
}

/* ---------- Counters Screen ---------- */
.jp-text {
  font-family: var(--font-jp);
}

.counters-table {
  border-collapse: collapse;
  width: 100%;
}

.counters-table th,
.counters-table td {
  border: 1px solid var(--border);
  padding: .45rem .6rem;
  font-size: .9rem;
}

.counters-table thead th {
  background: var(--surface);
  font-weight: 600;
}

.counter-irregular {
  color: var(--danger, #e53935);
  font-weight: 600;
}

.counter-alt {
  color: var(--text-muted);
  font-size: .8rem;
}

.counter-legend {
  margin-bottom: .75rem;
  font-size: .85rem;
}

.counter-legend-sample {
  display: inline-block;
  padding: .1rem .4rem;
  border-radius: 4px;
  font-weight: 600;
  font-size: .8rem;
}

.counter-card {
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1rem;
  margin-bottom: 1rem;
  background: var(--card-bg, var(--surface));
}

.counter-card-header {
  display: flex;
  align-items: center;
  gap: .75rem;
  margin-bottom: .75rem;
  flex-wrap: wrap;
}

.counter-kanji {
  font-size: 2.2rem;
  line-height: 1;
  min-width: 2.5rem;
}

.counter-info {
  display: flex;
  flex-direction: column;
  gap: .15rem;
  flex: 1;
}

.counter-reading-main {
  font-size: .95rem;
  font-weight: 600;
}

.counter-usage {
  font-size: .82rem;
  color: var(--text-muted);
}

.counter-lesson-badge {
  font-size: .75rem;
  padding: .2rem .5rem;
  border-radius: 12px;
  background: color-mix(in srgb, var(--accent) 15%, transparent);
  color: var(--accent);
  font-weight: 600;
  white-space: nowrap;
}

.counter-readings {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(8rem, 1fr));
  gap: .3rem;
  margin-bottom: .75rem;
}

.counter-reading {
  display: flex;
  align-items: center;
  gap: .3rem;
  padding: .3rem .45rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: .82rem;
  flex-wrap: wrap;
}

.counter-reading--irregular {
  border-color: color-mix(in srgb, var(--danger, #e53935) 40%, transparent);
  background: color-mix(in srgb, var(--danger, #e53935) 5%, transparent);
}

.counter-reading--irregular .cr-form,
.counter-reading--irregular .cr-kana {
  color: var(--danger, #e53935);
  font-weight: 600;
}

.cr-number {
  font-size: .75rem;
  color: var(--text-muted);
  min-width: 1rem;
}

.cr-form { font-size: .95rem; }
.cr-kana { font-size: .82rem; }
.cr-romaji { font-size: .75rem; color: var(--text-muted); }

.btn-speak--sm {
  padding: .1rem .25rem;
  font-size: .75rem;
  border-radius: 4px;
}

.counter-example {
  font-size: .85rem;
  padding: .5rem .6rem;
  background: var(--surface);
  border-radius: 6px;
  display: flex;
  gap: .75rem;
  flex-wrap: wrap;
  align-items: baseline;
}

.counter-example .jp-text {
  font-size: .95rem;
}

.counter-example-vi {
  color: var(--text-muted);
  font-size: .82rem;
}

@media (max-width: 480px) {
  .alpha-kana  { font-size: 1.1rem; }
  .alpha-table th, .alpha-table td { min-width: 2.6rem; padding: .25rem; }
  .counter-readings { grid-template-columns: repeat(auto-fill, minmax(7rem, 1fr)); }
}

/* ---------- Quiz Panel (Alphabet + Counters screens) ---------- */
.quiz-panel {
  margin-top: 2rem;
  padding: 1.25rem 1.5rem;
  border: 2px solid var(--border);
  border-radius: 12px;
  background: var(--surface);
}

.quiz-panel-title {
  font-size: 1.05rem;
  font-weight: 700;
  margin-bottom: 1rem;
}

.quiz-panel-config {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  align-items: center;
  margin-bottom: 1rem;
  font-size: .9rem;
}

.quiz-panel-config label {
  display: flex;
  align-items: center;
  gap: .4rem;
}

.quiz-panel-config select {
  padding: .3rem .5rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
  font-size: .875rem;
}

.quiz-panel-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: .6rem;
}
